<div class="w-full overflow-auto">
    <div class="flex lg:flex-row flex-col lg:items-center justify-between mb-4 w-full gap-6">
        <div class="flex-1">
            <div class="label-medium">Mini-jeux</div>
            <span class="mt-1 body-xsmall">Liste des mini-jeux de BastionMC</span>
        </div>
        <div class="flex flex-wrap items-center gap-3.5">
            <p-icon-field>
                <p-inputicon class="pi pi-search"/>
                <input pInputText class="!rounded-lg !py-1.5 !w-56" [(ngModel)]="tableSearch"
                       placeholder="Rechercher"/>
            </p-icon-field>
        </div>
    </div>
    <div class="w-full overflow-hidden">
        <p-table
            [value]="minigames"
            [rows]="7"
            [paginator]="true"
            [showCurrentPageReport]="true"
            currentPageReportTemplate="Page {currentPage} sur {totalPages}"
            [globalFilterFields]="['name']"
            [(selection)]="selectedMiniGame"
            dataKey="id"
            [filterDelay]="0"
        >
            <ng-template pTemplate="header">
                <tr>
                    <th>Nom</th>
                    <th>RAM</th>
                    <th>CPU</th>
                    <th>Serveurs</th>
                    <th>Démarrage</th>
                    <th>TPS</th>
                    <th>Joueurs</th>
                    <th></th>
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-minigame>
                <tr [pSelectableRow]="minigame">
                    <td style="max-width: 180px; min-width: 150px;">
                        <div class="flex items-center">
                            <p-avatar
                                [label]="minigame.name.charAt(0) + (minigame.name.includes(' ') ? minigame.name.split(' ')[1].charAt(0) : '')"
                                styleClass="mr-2 !w-8 !h-8 !text-xs font-medium flex-shrink-0"
                                [style]="{ backgroundColor: 'var(--p-' + minigame.color + '-100)', color: 'var(--p-' + minigame.color + '-950)' }"
                                shape="circle"
                            />
                            <div class="flex flex-col overflow-hidden">
                                <div class="label-xsmall text-surface-950 dark:text-surface-0 truncate"
                                     [pTooltip]="minigame.name" tooltipPosition="top">{{ minigame.name }}
                                </div>
                                <div class="text-xs text-surface-500 dark:text-surface-400">#{{ minigame.id }}</div>
                            </div>
                        </div>
                    </td>
                    <td>
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>RAM</span>
                                <span>{{ minigame.resources.ram }}</span>
                            </div>
                            <p-progressBar
                                [value]="minigame.resources.ramUsage"
                                [showValue]="false"
                                [style]="{'height': '5px'}"
                                styleClass="!rounded-full"
                            />
                        </div>
                    </td>
                    <td>
                        <div>
                            <div class="flex justify-between text-xs mb-1">
                                <span>CPU</span>
                                <span>{{ minigame.resources.cpu }}%</span>
                            </div>
                            <p-progressBar
                                [value]="minigame.resources.cpu"
                                [showValue]="false"
                                [style]="{'height': '5px'}"
                                styleClass="!rounded-full"
                            />
                        </div>
                    </td>
                    <td>
                        <div class="body-xsmall text-left text-surface-950 dark:text-surface-0">
                            {{ minigame.servers }}
                        </div>
                    </td>
                    <td>
                        <div class="body-xsmall text-left text-surface-950 dark:text-surface-0">
                            {{ minigame.startupTime }}s
                        </div>
                    </td>
                    <td>
                        <div class="body-xsmall text-left">
                            <p-tag
                                [severity]="minigame.tps.status"
                                [value]="minigame.tps.value.toFixed(1)"
                                styleClass="!px-2 !py-1 !rounded-lg"
                                pTooltip="TPS optimal: 20"
                            />
                        </div>
                    </td>

                    <td>
                        <div class="body-xsmall text-left text-surface-950 dark:text-surface-0">
                            {{ minigame.players }}
                        </div>
                    </td>
                    <td>
                        <div class="flex gap-2 items-end justify-end">
                            <p-button [link]="['minigame', minigame.id]" icon="pi pi-play" aria-label="Save" size="small" severity="success"/>
                            <a pButtonIcon [routerLink]="['minigame', minigame.id]">
                                <p-button icon="pi pi-info" aria-label="Save" size="small"/>
                            </a>
                        </div>
                    </td>
                </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
                <tr>
                    <td colspan="7" class="text-center p-4">Aucun mini-jeu trouvé.</td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>
